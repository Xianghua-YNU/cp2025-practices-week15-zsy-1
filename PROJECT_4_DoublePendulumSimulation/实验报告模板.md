# 项目1：双摆动力学仿真 - 实验报告

**学生姓名：** [朱思宇]  
**学号：** [20221170050]  
**完成日期：** [2025.6.5]

## 1. 实验目的
（1-2句话描述本次实验的学习目标，例如：通过数值求解双摆的运动方程，理解其混沌特性，并分析能量守恒情况。）
[通过数值求解双摆的运动方程，理解其混沌特性，并分析能量守恒情况。]
## 2. 核心算法与实现

### 2.1 运动方程的数值解法
（简述你是如何设置并调用 `scipy.integrate.odeint` 来求解双摆的微分方程组的。提及你定义的 `derivatives` 函数的关键作用。）
[为了求解双摆的微分方程组，使用了 scipy.integrate.odeint。首先定义了一个 derivatives 函数，该函数返回摆的角速度和角加速度。derivatives 函数根据双摆的运动方程计算出当前时间点的导数，这些导数随后被 odeint 用于数值积分以获得摆的角度和角速度随时间的变化。通过调整 odeint 的参数（如相对容差 rtol 和绝对容差 atol）以及增加时间点 t_points，我们确保了数值解的精度。]
### 2.2 能量计算方法
（说明你是如何根据 $\theta_1, \omega_1, \theta_2, \omega_2$ 计算系统的总动能 $T$ 和总势能 $V$ 的，并给出总能量 $E = T+V$ 的表达式。）
[系统的总动能 T 和总势能 V 根据双摆的角度 θ_1,θ_2和角速度 ω_1,ω_2计算得出。总能量 E=T+V，具体表达式如下：![1749123079952](https://github.com/user-attachments/assets/fc5270cb-2c48-42ab-9fbf-ad7764c66c19)![1749123110612](https://github.com/user-attachments/assets/3d9c5494-8e0b-4d10-bc10-5d55034964fb)

![1749122158192](https://github.com/user-attachments/assets/357e7381-fee4-4485-b4fb-f209d5b26b18)
]
### 2.3 关键代码片段
```python
# 粘贴你认为最核心的1-2个代码片段，例如 derivatives 函数的实现，或者能量计算部分。
# derivatives_student 函数实现：
# def derivatives_student(y, t, L1, L2, m1, m2, g):
#    theta1, omega1, theta2, omega2 = y
#    dtheta1_dt = omega1
#    dtheta2_dt = omega2
#    num1 = -omega1**2 * np.sin(2*theta1 - 2*theta2) \
           - 2 * omega2**2 * np.sin(theta1 - theta2) \
           - (g/L1) * (np.sin(theta1 - 2*theta2) + 3*np.sin(theta1))
#     den1 = 3 - np.cos(2*theta1 - 2*theta2)
#     domega1_dt = num1 / den1


#     num2 = 4 * omega1**2 * np.sin(theta1 - theta2) \
           + omega2**2 * np.sin(2*theta1 - 2*theta2) \
           + 2 * (g/L1) * (np.sin(2*theta1 - theta2) - np.sin(theta2))
#     den2 = 3 - np.cos(2*theta1 - 2*theta2)
#     domega2_dt = num2 / den2
#     return [dtheta1_dt, domega1_dt, dtheta2_dt, domega2_dt]

# 能量计算部分：
# def calculate_energy_student(sol_arr, L_param, m_param, g_param):
#     theta1 = sol_arr[:, 0]
#     # ... (你的实现)
#     V = -m_param * g_param * L_param * (2 * np.cos(theta1) + np.cos(theta2))
#     T = m_param * L_param**2 * (omega1**2 + 0.5 * omega2**2 + omega1 * omega2 * np.cos(theta1 - theta2))
#     E = T + V
#     return E
```

## 3. 实验结果与分析

### 3.1 能量守恒分析
（粘贴你生成的“能量 vs. 时间”图像。分析图像，讨论能量是否守恒。如果存在数值误差导致的不守恒，量化这个误差（例如，总能量的变化范围或标准差），并讨论你是如何通过调整 `odeint` 的参数（如 `rtol`, `atol`）或增加 `t_points` 来尝试满足题目 $10^{-5}$ 焦耳的精度要求的。）
[从图中可以看出，双摆系统的总能量在模拟过程中表现出小幅波动。这主要是由于数值解法的误差所致。总能量的变化范围在 −1.25×10^−7J 到 0.5×10^−7J 之间，标准差约为 1.868×10^−7J，满足题目要求的 10^−5J 的精度。为了减小数值误差，尝试了以下方法：调整 odeint 的参数 rtol 和 atol，设置为 1×10^−8。增加时间点 t_points 至 1000 个，以提高解的时间分辨率。]
**(在此处插入能量随时间变化的图像)**
![image](https://github.com/user-attachments/assets/28ace091-5d33-44b0-a41f-1124021ff0ac)

### 3.2 双摆运动轨迹 (可选，如果未做动画则省略)
（如果你完成了动画部分，可以简要描述双摆的典型运动特征，例如混沌行为、对初始条件的敏感性等。可以附上一张动画中的截图。）

**(在此处插入动画截图，如果适用)**

## 4. 问题与收获

### 4.1 遇到的主要问题
（列出1-2个在实现过程中遇到的主要困难或挑战，例如：理解微分方程组、调试 `odeint` 参数、实现动画等。）
[调试 odeint 参数——找到合适的参数设置以确保解的精度和稳定性。]
### 4.2 解决方法与学习心得
（简述你是如何解决上述问题的。总结通过本次实验学到的主要知识点、技能或对计算物理的理解，例如：数值求解ODE的经验、混沌系统特性、能量分析的重要性等。）
[通过查阅相关文献和教程，逐步理解了双摆的运动方程，并实现了数值解法。调整 odeint 的参数后，解的精度得到了显著提高。通过本次实验，掌握了数值求解常微分方程的经验，深入理解了混沌系统的基本特性以及能量分析的重要性。]
### 4.3 主要收获
（用3-5句话总结你从这个项目中学到的最重要的东西。）
[对双摆的混沌行为有了更深入的认识，学会了如何使用数值方法求解复杂的物理系统，并分析系统的能量守恒特性。]
## 5. 思考题（可选）

1.  如果双摆的两个摆臂长度不同（ $L_1 \neq L_2$）或两个摆锤质量不同（ $m_1 \neq m_2$），运动方程会如何变化？你将如何修改你的 `derivatives` 函数来适应这种情况？（提示：需要回顾拉格朗日方程的推导或查找更通用的双摆方程。）
2.  双摆的运动对初始条件高度敏感。尝试稍微改变初始角度（例如，将 $\theta_1$ 或 $\theta_2$ 改变 $0.001$ 弧度），重新运行仿真，并比较两个轨迹（例如，绘制 $\theta_1(t)$ 的对比图）。你观察到了什么现象？这与混沌理论有什么关系？
[如果双摆的两个摆臂长度不同$L_1 \neq L_2$或两个摆锤质量不同$m_1 \neq m_2$ ，运动方程将发生变化。需要重新推导拉格朗日方程，并相应修改 derivatives 函数中的动力学参数。]
[双摆的运动对初始条件高度敏感。在实验中，我们将初始角度改变 0.001 弧度后，发现两个轨迹在短时间内迅速发散，体现了混沌系统的蝴蝶效应。]
---

_报告长度建议：500-1000字（不含代码和图片），重点关注对物理模型、数值方法和结果分析的理解与反思。_
